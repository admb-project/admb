all:
	CXX=@cxx@ CXXFLAGS="@arch_cxxflag@" LIBPATH=@libpath@ DISK=@disk@ ADMB_CONFIGURE=1 make --directory=src --file=@makefile@
	rm -rf `find build/@target@/dist -type d -name .svn`
	@printf "\nBuild completed for @target@\n"
	@printf "To install ADMB to '@prefix@/bin' and '@prefix@/admb', type 'make install'\n"

debug:
	DEBUG=1 CXX=@cxx@ CXXFLAGS="@arch_cxxflag@" LIBPATH=@libpath@ DISK=@disk@ ADMB_CONFIGURE=1 make --directory=src --file=@makefile@
	rm -rf `find build/@target@/dist -type d -name .svn`
	@printf "\nBuild completed for @target@\n"
	@printf "To install ADMB to '@prefix@/bin' and '@prefix@/admb', type 'make install'\n"

dist:
	mkdir -p build/dist
	rm -rf build/dist/admb-@version@@revision@-src
	svn export . build/dist/admb-@version@@revision@-src
	rm -rf build/dist/admb-@version@@revision@-src/test
	cp configure build/dist/admb-@version@@revision@-src
	cd build/dist && zip -r admb-@version@@revision@-src.zip admb-@version@@revision@-src 

verify:
	DISK=@disk@ make --directory=src --file=@makefile@ verify

install:
	install -d -m 555 @prefix@/admb/bin @prefix@/admb/include @prefix@/admb/lib @prefix@/admb/docs @prefix@/admb/examples
	install -m 555 build/@target@/dist/bin/* @prefix@/admb/bin
	install -m 444 build/@target@/dist/include/* @prefix@/admb/include
	install -m 444 build/@target@/dist/lib/* @prefix@/admb/lib
	install -m 444 LICENSE @prefix@/admb
	install -m 444 README @prefix@/admb
	install -m 444 Makefile @prefix@/admb
	install -m 555 scripts/bash/admb-bin @prefix@/bin/admb
	cp -Rf build/@target@/dist/docs/* @prefix@/admb/docs
	cp -Rf build/@target@/dist/examples/* @prefix@/admb/examples

test:
	make --directory=test

clean:
	make --directory=src --file=@makefile@ clean
