DISTRIBUTION_NAME=ADMB

#TIGER=10.4
#LEOPARD=10.5
#SNOW_LEOPARD=10.6

CC=/Developer/Applications/Utilities/PackageMaker.app/Contents/MacOS/PackageMaker

all:
	rm -rvf build/@target@/Resources
	mkdir -p build/@target@/Resources

	rm -rvf build/@target@/installer
	mkdir -p build/@target@/installer/usr/local/bin
	mkdir -p build/@target@/installer/usr/local/admb

	cp -Rvf build/@target@/@target@/* build/@target@/installer/usr/local/admb
	rm -rvf `find build/@target@/installer -type d -name .svn`

	cp -vf scripts/admb/admb-bin build/@target@/installer/usr/local/bin/admb

	cp -vf build/@target@/installer/usr/local/admb/README.txt build/@target@/Resources/Welcome.txt
	cp -vf build/@target@/installer/usr/local/admb/LICENSE build/@target@/Resources/License.txt
	cp -vf scripts/installers/packagemaker/Resources/background.jpg  build/@target@/Resources/
	mkdir -p build/@target@/package
	cp -vf docs/install/readme-macos.txt  build/@target@/package
	$(CC) --verbose --title $(DISTRIBUTION_NAME) --root build/@target@/installer --id www.admb-project.org --resources build/@target@/Resources --out build/@target@/package/@target@.pkg
	rm -vf build/@target@/@target@.dmg
	hdiutil create build/@target@/@target@.dmg -volname "ADMB @version@" -srcfolder build/@target@/package
